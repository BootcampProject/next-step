{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.withFilter = void 0;\n\nvar iterall_1 = require(\"iterall\");\n\nexports.withFilter = function (asyncIteratorFn, filterFn) {\n  return function (rootValue, args, context, info) {\n    var _a;\n\n    var asyncIterator = asyncIteratorFn(rootValue, args, context, info);\n\n    var getNextPromise = function () {\n      return new Promise(function (resolve, reject) {\n        var inner = function () {\n          asyncIterator.next().then(function (payload) {\n            if (payload.done === true) {\n              resolve(payload);\n              return;\n            }\n\n            Promise.resolve(filterFn(payload.value, args, context, info)).catch(function () {\n              return false;\n            }).then(function (filterResult) {\n              if (filterResult === true) {\n                resolve(payload);\n                return;\n              }\n\n              inner();\n              return;\n            });\n          }).catch(function (err) {\n            reject(err);\n            return;\n          });\n        };\n\n        inner();\n      });\n    };\n\n    var asyncIterator2 = (_a = {\n      next: function () {\n        return getNextPromise();\n      },\n      return: function () {\n        return asyncIterator.return();\n      },\n      throw: function (error) {\n        return asyncIterator.throw(error);\n      }\n    }, _a[iterall_1.$$asyncIterator] = function () {\n      return this;\n    }, _a);\n    return asyncIterator2;\n  };\n};","map":{"version":3,"sources":["../src/with-filter.ts"],"names":[],"mappings":";;;;;;;AAAA,IAAA,SAAA,GAAA,OAAA,CAAA,SAAA,CAAA;;AASa,OAAA,CAAA,UAAA,GAAa,UAAC,eAAD,EAA8B,QAA9B,EAAgD;AACxE,SAAO,UAAC,SAAD,EAAiB,IAAjB,EAA4B,OAA5B,EAA0C,IAA1C,EAAmD;;;AACxD,QAAM,aAAa,GAAG,eAAe,CAAC,SAAD,EAAY,IAAZ,EAAkB,OAAlB,EAA2B,IAA3B,CAArC;;AAEA,QAAM,cAAc,GAAG,YAAA;AACrB,aAAO,IAAI,OAAJ,CAAiC,UAAC,OAAD,EAAU,MAAV,EAAgB;AAEtD,YAAM,KAAK,GAAG,YAAA;AACZ,UAAA,aAAa,CACV,IADH,GAEG,IAFH,CAEQ,UAAA,OAAA,EAAO;AACX,gBAAI,OAAO,CAAC,IAAR,KAAiB,IAArB,EAA2B;AACzB,cAAA,OAAO,CAAC,OAAD,CAAP;AACA;AACD;;AACD,YAAA,OAAO,CAAC,OAAR,CAAgB,QAAQ,CAAC,OAAO,CAAC,KAAT,EAAgB,IAAhB,EAAsB,OAAtB,EAA+B,IAA/B,CAAxB,EACG,KADH,CACS,YAAA;AAAM,qBAAA,KAAA;AAAK,aADpB,EAEG,IAFH,CAEQ,UAAA,YAAA,EAAY;AAChB,kBAAI,YAAY,KAAK,IAArB,EAA2B;AACzB,gBAAA,OAAO,CAAC,OAAD,CAAP;AACA;AACD;;AAED,cAAA,KAAK;AACL;AACD,aAVH;AAWD,WAlBH,EAmBG,KAnBH,CAmBS,UAAC,GAAD,EAAI;AACT,YAAA,MAAM,CAAC,GAAD,CAAN;AACA;AACD,WAtBH;AAuBD,SAxBD;;AA0BA,QAAA,KAAK;AAEN,OA9BM,CAAP;AA+BD,KAhCD;;AAkCA,QAAM,cAAc,IAAA,EAAA,GAAA;AAClB,MAAA,IAAI,EAAA,YAAA;AACF,eAAO,cAAc,EAArB;AACD,OAHiB;AAIlB,MAAA,MAAM,EAAA,YAAA;AACJ,eAAO,aAAa,CAAC,MAAd,EAAP;AACD,OANiB;AAOlB,MAAA,KAAK,EAAA,UAAC,KAAD,EAAM;AACT,eAAO,aAAa,CAAC,KAAd,CAAoB,KAApB,CAAP;AACD;AATiB,KAAA,EAUlB,EAAA,CAAC,SAAA,CAAA,eAAD,CAAA,GAAA,YAAA;AACE,aAAO,IAAP;AACD,KAZiB,EAanB,EAbmB,CAApB;AAeA,WAAO,cAAP;AACD,GArDD;AAsDD,CAvDY","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withFilter = void 0;\nvar iterall_1 = require(\"iterall\");\nexports.withFilter = function (asyncIteratorFn, filterFn) {\n    return function (rootValue, args, context, info) {\n        var _a;\n        var asyncIterator = asyncIteratorFn(rootValue, args, context, info);\n        var getNextPromise = function () {\n            return new Promise(function (resolve, reject) {\n                var inner = function () {\n                    asyncIterator\n                        .next()\n                        .then(function (payload) {\n                        if (payload.done === true) {\n                            resolve(payload);\n                            return;\n                        }\n                        Promise.resolve(filterFn(payload.value, args, context, info))\n                            .catch(function () { return false; })\n                            .then(function (filterResult) {\n                            if (filterResult === true) {\n                                resolve(payload);\n                                return;\n                            }\n                            inner();\n                            return;\n                        });\n                    })\n                        .catch(function (err) {\n                        reject(err);\n                        return;\n                    });\n                };\n                inner();\n            });\n        };\n        var asyncIterator2 = (_a = {\n                next: function () {\n                    return getNextPromise();\n                },\n                return: function () {\n                    return asyncIterator.return();\n                },\n                throw: function (error) {\n                    return asyncIterator.throw(error);\n                }\n            },\n            _a[iterall_1.$$asyncIterator] = function () {\n                return this;\n            },\n            _a);\n        return asyncIterator2;\n    };\n};\n//# sourceMappingURL=with-filter.js.map"]},"metadata":{},"sourceType":"script"}